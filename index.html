<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global FM Radio</title>
    <script src="https://cdn.jsdelivr.net/npm/tsparticles-slim@2.0.6/tsparticles.slim.min.js"></script>
    <style>
        :root {
            --primary-color: #4285f4;
            --secondary-color: #34a853;
            --accent-color: #ea4335;
            --text-primary: #202124;
            --text-secondary: #5f6368;
            --bg-primary: #ffffff;
            --bg-secondary: #f1f3f4;
            --bg-tertiary: #e8f0fe;
            --border-color: #dadce0;
            --shadow: 0 1px 2px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
            --radius: 8px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            --font-size-sm: 0.875rem;
            --font-size-md: 1rem;
            --font-size-lg: 1.25rem;
            --font-size-xl: 1.5rem;
            --font-size-xxl: 2rem;
        }

        [data-theme="dark"] {
            --primary-color: #8ab4f8;
            --secondary-color: #81c995;
            --accent-color: #f28b82;
            --text-primary: #e8eaed;
            --text-secondary: #9aa0a6;
            --bg-primary: #202124;
            --bg-secondary: #303134;
            --bg-tertiary: #41331c;
            --border-color: #5f6368;
            --shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        [data-theme="dark"] .neon {
            text-shadow: 0 0 5px var(--primary-color), 
                         0 0 10px var(--primary-color), 
                         0 0 20px var(--primary-color);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            transition: var(--transition);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }

        #particles-js {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.2;
            transition: var(--transition);
        }

        .particles-disabled {
            display: none;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--spacing-lg);
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-xl);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--border-color);
        }

        .logo {
            font-size: var(--font-size-xxl);
            font-weight: bold;
            color: var(--primary-color);
        }

        .settings-btn {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: var(--font-size-lg);
            cursor: pointer;
            transition: var(--transition);
            padding: var(--spacing-sm);
            border-radius: 50%;
        }

        .settings-btn:hover {
            background-color: var(--bg-secondary);
            transform: rotate(30deg);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--spacing-xl);
        }

        @media (min-width: 768px) {
            .main-content {
                grid-template-columns: 1fr 2fr;
            }
        }

        .player-section {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        .now-playing {
            background-color: var(--bg-secondary);
            border-radius: var(--radius);
            padding: var(--spacing-lg);
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .station-info {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .station-name {
            font-size: var(--font-size-lg);
            font-weight: bold;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .station-country {
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
        }

        .station-meta {
            display: flex;
            gap: var(--spacing-md);
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .player-controls {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: var(--spacing-md);
        }

        .play-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }

        .play-btn:hover {
            transform: scale(1.05);
        }

        .play-btn i {
            font-size: var(--font-size-xl);
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            flex-grow: 1;
            max-width: 150px;
        }

        .volume-slider {
            width: 100%;
            height: 4px;
            -webkit-appearance: none;
            appearance: none;
            background-color: var(--border-color);
            border-radius: 2px;
            outline: none;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: var(--primary-color);
            cursor: pointer;
        }

        .volume-icon {
            font-size: var(--font-size-md);
            color: var(--text-secondary);
        }

        .stations-section {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        .search-filter {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        @media (min-width: 480px) {
            .search-filter {
                flex-direction: row;
            }
        }

        .country-select, .search-input {
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-size: var(--font-size-md);
            transition: var(--transition);
            flex-grow: 1;
        }

        .country-select {
            max-width: 200px;
        }

        .search-input {
            flex-grow: 1;
        }

        .country-select:focus, .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(66, 133, 244, 0.2);
        }

        .stations-list {
            background-color: var(--bg-secondary);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .stations-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md) var(--spacing-lg);
            background-color: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-color);
        }

        .stations-title {
            font-size: var(--font-size-lg);
            font-weight: bold;
        }

        .stations-count {
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
        }

        .stations-container {
            max-height: 500px;
            overflow-y: auto;
        }

        /* Custom scrollbar */
        .stations-container::-webkit-scrollbar {
            width: 8px;
        }

        .stations-container::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        .stations-container::-webkit-scrollbar-thumb {
            background-color: var(--border-color);
            border-radius: 4px;
        }

        .stations-container::-webkit-scrollbar-thumb:hover {
            background-color: var(--text-secondary);
        }

        .station-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md) var(--spacing-lg);
            border-bottom: 1px solid var(--border-color);
            transition: var(--transition);
            cursor: pointer;
        }

        .station-item:last-child {
            border-bottom: none;
        }

        .station-item:hover {
            background-color: var(--bg-tertiary);
        }

        .station-item.active {
            background-color: var(--bg-tertiary);
            border-left: 4px solid var(--primary-color);
        }

        .station-item-content {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
            flex-grow: 1;
            min-width: 0;
        }

        .station-item-name {
            font-weight: bold;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .station-item-tags {
            display: flex;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
        }

        .tag {
            background-color: var(--bg-primary);
            color: var(--text-secondary);
            padding: 2px var(--spacing-sm);
            border-radius: 10px;
            font-size: var(--font-size-sm);
        }

        .station-item-actions {
            display: flex;
            gap: var(--spacing-md);
            align-items: center;
        }

        .fav-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: var(--font-size-lg);
            transition: var(--transition);
        }

        .fav-btn:hover {
            color: var(--accent-color);
        }

        .fav-btn.favorited {
            color: var(--accent-color);
        }

        .play-indicator {
            color: var(--primary-color);
            font-size: var(--font-size-sm);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .blinking {
            animation: blink 1.5s infinite;
        }

        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Skeleton loading */
        .skeleton {
            background-color: var(--border-color);
            border-radius: 4px;
            animation: pulse 1.5s infinite ease-in-out;
        }

        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 0.3; }
            100% { opacity: 0.6; }
        }

        .skeleton-text {
            height: 16px;
            width: 100%;
            margin-bottom: 8px;
        }

        .skeleton-text-sm {
            height: 12px;
            width: 60%;
        }

        /* Settings modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .modal {
            background-color: var(--bg-primary);
            border-radius: var(--radius);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--border-color);
        }

        .modal-title {
            font-size: var(--font-size-xl);
            font-weight: bold;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: var(--font-size-xl);
            cursor: pointer;
            color: var(--text-secondary);
            transition: var(--transition);
        }

        .close-btn:hover {
            color: var(--text-primary);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: var(--spacing-lg);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xl);
        }

        .settings-group {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .settings-title {
            font-size: var(--font-size-lg);
            font-weight: bold;
            margin-bottom: var(--spacing-sm);
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .setting-label {
            font-size: var(--font-size-md);
        }

        .select-wrapper, .toggle-wrapper {
            position: relative;
        }

        .setting-select {
            padding: var(--spacing-sm) var(--spacing-md);
            padding-right: 40px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-size: var(--font-size-md);
            appearance: none;
            cursor: pointer;
        }

        .select-arrow {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--border-color);
            transition: var(--transition);
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: var(--transition);
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--primary-color);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        .modal-footer {
            padding: var(--spacing-lg);
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
        }

        .save-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--radius);
            padding: var(--spacing-sm) var(--spacing-lg);
            font-size: var(--font-size-md);
            cursor: pointer;
            transition: var(--transition);
        }

        .save-btn:hover {
            background-color: var(--secondary-color);
        }

        /* Error message */
        .error-message {
            background-color: #fce8e6;
            color: #d93025;
            padding: var(--spacing-md);
            border-radius: var(--radius);
            margin-bottom: var(--spacing-lg);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .error-icon {
            font-size: var(--font-size-lg);
        }

        /* Language selector in header */
        .lang-selector {
            position: relative;
            margin-left: auto;
            margin-right: var(--spacing-md);
        }

        .lang-btn {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: var(--font-size-md);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .lang-dropdown {
            position: absolute;
            right: 0;
            top: 100%;
            background-color: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: var(--spacing-sm) 0;
            min-width: 120px;
            z-index: 100;
            display: none;
        }

        .lang-dropdown.show {
            display: block;
        }

        .lang-option {
            padding: var(--spacing-sm) var(--spacing-md);
            cursor: pointer;
            transition: var(--transition);
        }

        .lang-option:hover {
            background-color: var(--bg-secondary);
        }

        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* Mobile adjustments */
        @media (max-width: 767px) {
            .container {
                padding: var(--spacing-md);
            }

            .logo {
                font-size: var(--font-size-xl);
            }

            .station-item {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--spacing-md);
            }

            .station-item-actions {
                width: 100%;
                justify-content: flex-end;
            }
        }

        /* Icons - using Unicode as fallback */
        .icon {
            font-style: normal;
            font-family: Arial, sans-serif;
        }

        .icon-play::after {
            content: "‚ñ∂";
        }

        .icon-pause::after {
            content: "‚è∏";
        }

        .icon-volume::after {
            content: "üîä";
        }

        .icon-fav::after {
            content: "‚ô°";
        }

        .icon-faved::after {
            content: "‚ù§";
        }

        .icon-settings::after {
            content: "‚öô";
        }

        .icon-close::after {
            content: "√ó";
        }

        .icon-arrow::after {
            content: "‚ñº";
        }

        .icon-error::after {
            content: "‚ö†";
        }

        .icon-now-playing::after {
            content: "üéµ";
        }
    </style>
</head>
<body>
    <div id="particles-js" class="particles-disabled"></div>
    
    <div class="container">
        <header>
            <h1 class="logo neon">Global FM</h1>
            
            <div class="lang-selector">
                <button class="lang-btn" aria-haspopup="true" aria-expanded="false">
                    <span class="current-lang">EN</span>
                    <span class="icon icon-arrow" aria-hidden="true"></span>
                </button>
                <ul class="lang-dropdown" role="menu">
                    <li class="lang-option" role="menuitem" data-lang="en">English</li>
                    <li class="lang-option" role="menuitem" data-lang="es">Espa√±ol</li>
                    <li class="lang-option" role="menuitem" data-lang="fr">Fran√ßais</li>
                    <li class="lang-option" role="menuitem" data-lang="de">Deutsch</li>
                    <li class="lang-option" role="menuitem" data-lang="ja">Êó•Êú¨Ë™û</li>
                </ul>
            </div>
            
            <button class="settings-btn" aria-label="Settings">
                <span class="icon icon-settings" aria-hidden="true"></span>
            </button>
        </header>
        
        <main class="main-content">
            <section class="player-section">
                <div class="now-playing">
                    <div class="station-info">
                        <h2 class="station-name" id="current-station-name">No station selected</h2>
                        <span class="station-country" id="current-station-country">Select a station to play</span>
                        <div class="station-meta">
                            <span class="meta-item" id="current-bitrate">-</span>
                            <span class="meta-item" id="current-codec">-</span>
                        </div>
                    </div>
                    
                    <div class="player-controls">
                        <button class="play-btn" id="play-btn" aria-label="Play">
                            <span class="icon icon-play" aria-hidden="true"></span>
                        </button>
                        
                        <div class="volume-control">
                            <span class="icon icon-volume volume-icon" aria-hidden="true"></span>
                            <input type="range" class="volume-slider" id="volume-slider" min="0" max="1" step="0.01" aria-label="Volume control">
                        </div>
                    </div>
                </div>
                
                <div class="favorites-section">
                    <h3>Favorites</h3>
                    <div class="favorites-list" id="favorites-list">
                        <!-- Favorites will be loaded here -->
                    </div>
                </div>
            </section>
            
            <section class="stations-section">
                <div class="search-filter">
                    <select class="country-select" id="country-select" aria-label="Select country">
                        <option value="">Loading countries...</option>
                    </select>
                    
                    <input type="text" class="search-input" id="search-input" placeholder="Search stations..." aria-label="Search stations">
                </div>
                
                <div class="stations-list">
                    <div class="stations-header">
                        <h3 class="stations-title">Stations</h3>
                        <span class="stations-count" id="stations-count">0 stations</span>
                    </div>
                    
                    <div class="stations-container" id="stations-container">
                        <div class="station-item skeleton">
                            <div class="station-item-content">
                                <div class="skeleton skeleton-text" style="width: 70%"></div>
                                <div class="skeleton skeleton-text-sm" style="width: 50%"></div>
                            </div>
                        </div>
                        <div class="station-item skeleton">
                            <div class="station-item-content">
                                <div class="skeleton skeleton-text" style="width: 80%"></div>
                                <div class="skeleton skeleton-text-sm" style="width: 60%"></div>
                            </div>
                        </div>
                        <div class="station-item skeleton">
                            <div class="station-item-content">
                                <div class="skeleton skeleton-text" style="width: 60%"></div>
                                <div class="skeleton skeleton-text-sm" style="width: 40%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>
    
    <!-- Settings Modal -->
    <div class="modal-overlay" id="settings-modal">
        <div class="modal" role="dialog" aria-labelledby="modal-title" aria-modal="true">
            <div class="modal-header">
                <h2 class="modal-title" id="modal-title">Settings</h2>
                <button class="close-btn" aria-label="Close settings">
                    <span class="icon icon-close" aria-hidden="true"></span>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="settings-group">
                    <h3 class="settings-title">Appearance</h3>
                    
                    <div class="setting-item">
                        <span class="setting-label">Theme</span>
                        <div class="select-wrapper">
                            <select class="setting-select" id="theme-select">
                                <option value="light">Light</option>
                                <option value="dark">Dark</option>
                            </select>
                            <span class="icon icon-arrow select-arrow" aria-hidden="true"></span>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <span class="setting-label">Particle Background</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="particles-toggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="settings-group">
                    <h3 class="settings-title">Language</h3>
                    
                    <div class="setting-item">
                        <span class="setting-label">App Language</span>
                        <div class="select-wrapper">
                            <select class="setting-select" id="language-select">
                                <option value="en">English</option>
                                <option value="es">Espa√±ol</option>
                                <option value="fr">Fran√ßais</option>
                                <option value="de">Deutsch</option>
                                <option value="ja">Êó•Êú¨Ë™û</option>
                            </select>
                            <span class="icon icon-arrow select-arrow" aria-hidden="true"></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="save-btn" id="save-settings">Save Settings</button>
            </div>
        </div>
    </div>
    
    <!-- Audio Element (hidden) -->
    <audio id="audio-player" crossorigin="anonymous"></audio>
    
    <script>
        // App State
        const state = {
            currentStation: null,
            stations: [],
            favorites: [],
            countries: [],
            filteredStations: [],
            isPlaying: false,
            volume: 0.7,
            theme: 'light',
            particlesEnabled: false,
            language: 'en',
            translations: {
                en: {
                    noStation: "No station selected",
                    selectStation: "Select a station to play",
                    favorites: "Favorites",
                    stations: "Stations",
                    searchPlaceholder: "Search stations...",
                    settings: "Settings",
                    appearance: "Appearance",
                    language: "Language",
                    save: "Save Settings",
                    bitrate: "Bitrate",
                    codec: "Codec",
                    nowPlaying: "Now Playing",
                    loadingCountries: "Loading countries...",
                    stationCount: "{count} stations",
                    errorLoading: "Error loading stations. Please try again later."
                },
                es: {
                    noStation: "Ninguna estaci√≥n seleccionada",
                    selectStation: "Selecciona una estaci√≥n para reproducir",
                    favorites: "Favoritos",
                    stations: "Estaciones",
                    searchPlaceholder: "Buscar estaciones...",
                    settings: "Configuraci√≥n",
                    appearance: "Apariencia",
                    language: "Idioma",
                    save: "Guardar configuraci√≥n",
                    bitrate: "Tasa de bits",
                    codec: "C√≥dec",
                    nowPlaying: "Reproduciendo ahora",
                    loadingCountries: "Cargando pa√≠ses...",
                    stationCount: "{count} estaciones",
                    errorLoading: "Error al cargar estaciones. Por favor, int√©ntalo m√°s tarde."
                },
                fr: {
                    noStation: "Aucune station s√©lectionn√©e",
                    selectStation: "S√©lectionnez une station √† √©couter",
                    favorites: "Favoris",
                    stations: "Stations",
                    searchPlaceholder: "Rechercher des stations...",
                    settings: "Param√®tres",
                    appearance: "Apparence",
                    language: "Langue",
                    save: "Enregistrer les param√®tres",
                    bitrate: "D√©bit binaire",
                    codec: "Codec",
                    nowPlaying: "En cours de lecture",
                    loadingCountries: "Chargement des pays...",
                    stationCount: "{count} stations",
                    errorLoading: "Erreur lors du chargement des stations. Veuillez r√©essayer plus tard."
                },
                de: {
                    noStation: "Kein Sender ausgew√§hlt",
                    selectStation: "W√§hlen Sie einen Sender zum Abspielen aus",
                    favorites: "Favoriten",
                    stations: "Sender",
                    searchPlaceholder: "Sender suchen...",
                    settings: "Einstellungen",
                    appearance: "Erscheinungsbild",
                    language: "Sprache",
                    save: "Einstellungen speichern",
                    bitrate: "Bitrate",
                    codec: "Codec",
                    nowPlaying: "Jetzt spielt",
                    loadingCountries: "L√§nder werden geladen...",
                    stationCount: "{count} Sender",
                    errorLoading: "Fehler beim Laden der Sender. Bitte versuchen Sie es sp√§ter noch einmal."
                },
                ja: {
                    noStation: "„Çπ„ÉÜ„Éº„Ç∑„Éß„É≥„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì",
                    selectStation: "ÂÜçÁîü„Åô„Çã„Çπ„ÉÜ„Éº„Ç∑„Éß„É≥„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
                    favorites: "„ÅäÊ∞ó„Å´ÂÖ•„Çä",
                    stations: "„Çπ„ÉÜ„Éº„Ç∑„Éß„É≥",
                    searchPlaceholder: "„Çπ„ÉÜ„Éº„Ç∑„Éß„É≥„ÇíÊ§úÁ¥¢...",
                    settings: "Ë®≠ÂÆö",
                    appearance: "Â§ñË¶≥",
                    language: "Ë®ÄË™û",
                    save: "Ë®≠ÂÆö„Çí‰øùÂ≠ò",
                    bitrate: "„Éì„ÉÉ„Éà„É¨„Éº„Éà",
                    codec: "„Ç≥„Éº„Éá„ÉÉ„ÇØ",
                    nowPlaying: "ÂÜçÁîü‰∏≠",
                    loadingCountries: "ÂõΩ„ÇíË™≠„ÅøËæº„Åø‰∏≠...",
                    stationCount: "{count} „Çπ„ÉÜ„Éº„Ç∑„Éß„É≥",
                    errorLoading: "„Çπ„ÉÜ„Éº„Ç∑„Éß„É≥„ÅÆË™≠„ÅøËæº„Åø‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü„ÄÇÂæå„Åß„ÇÇ„ÅÜ‰∏ÄÂ∫¶„ÅäË©¶„Åó„Åè„Å†„Åï„ÅÑ„ÄÇ"
                }
            }
        };

        // DOM Elements
        const elements = {
            audioPlayer: document.getElementById('audio-player'),
            playBtn: document.getElementById('play-btn'),
            volumeSlider: document.getElementById('volume-slider'),
            currentStationName: document.getElementById('current-station-name'),
            currentStationCountry: document.getElementById('current-station-country'),
            currentBitrate: document.getElementById('current-bitrate'),
            currentCodec: document.getElementById('current-codec'),
            countrySelect: document.getElementById('country-select'),
            searchInput: document.getElementById('search-input'),
            stationsContainer: document.getElementById('stations-container'),
            stationsCount: document.getElementById('stations-count'),
            favoritesList: document.getElementById('favorites-list'),
            settingsModal: document.getElementById('settings-modal'),
            themeSelect: document.getElementById('theme-select'),
            particlesToggle: document.getElementById('particles-toggle'),
            languageSelect: document.getElementById('language-select'),
            saveSettingsBtn: document.getElementById('save-settings'),
            modalTitle: document.getElementById('modal-title'),
            particlesJs: document.getElementById('particles-js'),
            langSelector: document.querySelector('.lang-selector'),
            langBtn: document.querySelector('.lang-btn'),
            langDropdown: document.querySelector('.lang-dropdown'),
            currentLang: document.querySelector('.current-lang')
        };

        // Initialize the app
        function init() {
            loadSettings();
            setupEventListeners();
            loadCountries();
            loadFavorites();
            updateUI();
        }

        // Load user settings from localStorage
        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('radioPlayerSettings')) || {};
            
            state.theme = settings.theme || 'light';
            state.particlesEnabled = settings.particlesEnabled || false;
            state.language = settings.language || 'en';
            state.volume = settings.volume || 0.7;
            
            // Apply settings
            document.documentElement.setAttribute('data-theme', state.theme);
            elements.audioPlayer.volume = state.volume;
            elements.volumeSlider.value = state.volume;
            
            if (state.particlesEnabled) {
                elements.particlesJs.classList.remove('particles-disabled');
                initParticles();
            }
            
            // Update selects
            elements.themeSelect.value = state.theme;
            elements.particlesToggle.checked = state.particlesEnabled;
            elements.languageSelect.value = state.language;
            elements.currentLang.textContent = state.language.toUpperCase();
        }

        // Save user settings to localStorage
        function saveSettings() {
            const settings = {
                theme: state.theme,
                particlesEnabled: state.particlesEnabled,
                language: state.language,
                volume: state.volume
            };
            
            localStorage.setItem('radioPlayerSettings', JSON.stringify(settings));
        }

        // Set up event listeners
        function setupEventListeners() {
            // Play/Pause button
            elements.playBtn.addEventListener('click', togglePlay);
            
            // Volume control
            elements.volumeSlider.addEventListener('input', (e) => {
                state.volume = parseFloat(e.target.value);
                elements.audioPlayer.volume = state.volume;
                saveSettings();
            });
            
            // Country select
            elements.countrySelect.addEventListener('change', (e) => {
                loadStations(e.target.value);
            });
            
            // Search input
            elements.searchInput.addEventListener('input', (e) => {
                filterStations(e.target.value);
            });
            
            // Settings modal
            document.querySelector('.settings-btn').addEventListener('click', openSettings);
            document.querySelector('.close-btn').addEventListener('click', closeSettings);
            elements.saveSettingsBtn.addEventListener('click', saveSettingsAndClose);
            
            // Language selector
            elements.langBtn.addEventListener('click', toggleLangDropdown);
            document.querySelectorAll('.lang-option').forEach(option => {
                option.addEventListener('click', (e) => {
                    const lang = e.target.getAttribute('data-lang');
                    changeLanguage(lang);
                    toggleLangDropdown();
                });
            });
            
            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (!elements.langSelector.contains(e.target)) {
                    elements.langDropdown.classList.remove('show');
                }
            });
            
            // Audio player events
            elements.audioPlayer.addEventListener('play', () => {
                state.isPlaying = true;
                updatePlayButton();
            });
            
            elements.audioPlayer.addEventListener('pause', () => {
                state.isPlaying = false;
                updatePlayButton();
            });
            
            elements.audioPlayer.addEventListener('error', () => {
                console.error('Error playing audio');
                state.isPlaying = false;
                updatePlayButton();
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeSettings();
                }
                
                // Space to play/pause when not focused on input
                if (e.key === ' ' && document.activeElement.tagName !== 'INPUT') {
                    e.preventDefault();
                    togglePlay();
                }
            });
        }

        // Toggle language dropdown
        function toggleLangDropdown() {
            elements.langDropdown.classList.toggle('show');
            const isExpanded = elements.langDropdown.classList.contains('show');
            elements.langBtn.setAttribute('aria-expanded', isExpanded);
        }

        // Change app language
        function changeLanguage(lang) {
            state.language = lang;
            elements.currentLang.textContent = lang.toUpperCase();
            updateUI();
            saveSettings();
        }

        // Open settings modal
        function openSettings() {
            elements.settingsModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Close settings modal
        function closeSettings() {
            elements.settingsModal.classList.remove('active');
            document.body.style.overflow = '';
        }

        // Save settings and close modal
        function saveSettingsAndClose() {
            state.theme = elements.themeSelect.value;
            state.particlesEnabled = elements.particlesToggle.checked;
            state.language = elements.languageSelect.value;
            
            // Apply theme
            document.documentElement.setAttribute('data-theme', state.theme);
            
            // Apply particles
            if (state.particlesEnabled) {
                elements.particlesJs.classList.remove('particles-disabled');
                initParticles();
            } else {
                elements.particlesJs.classList.add('particles-disabled');
            }
            
            // Update language
            changeLanguage(state.language);
            
            saveSettings();
            closeSettings();
        }

        // Initialize particles.js background
        function initParticles() {
            tsParticles.load("particles-js", {
                particles: {
                    number: {
                        value: 80,
                        density: {
                            enable: true,
                            value_area: 800
                        }
                    },
                    color: {
                        value: state.theme === 'dark' ? "#8ab4f8" : "#4285f4"
                    },
                    shape: {
                        type: "circle",
                        stroke: {
                            width: 0,
                            color: "#000000"
                        }
                    },
                    opacity: {
                        value: 0.5,
                        random: true,
                        anim: {
                            enable: true,
                            speed: 1,
                            opacity_min: 0.1,
                            sync: false
                        }
                    },
                    size: {
                        value: 3,
                        random: true,
                        anim: {
                            enable: false,
                            speed: 40,
                            size_min: 0.1,
                            sync: false
                        }
                    },
                    line_linked: {
                        enable: true,
                        distance: 150,
                        color: state.theme === 'dark' ? "#8ab4f8" : "#4285f4",
                        opacity: 0.4,
                        width: 1
                    },
                    move: {
                        enable: true,
                        speed: 2,
                        direction: "none",
                        random: false,
                        straight: false,
                        out_mode: "out",
                        bounce: false,
                        attract: {
                            enable: false,
                            rotateX: 600,
                            rotateY: 1200
                        }
                    }
                },
                interactivity: {
                    detect_on: "canvas",
                    events: {
                        onhover: {
                            enable: true,
                            mode: "grab"
                        },
                        onclick: {
                            enable: true,
                            mode: "push"
                        },
                        resize: true
                    },
                    modes: {
                        grab: {
                            distance: 140,
                            line_linked: {
                                opacity: 1
                            }
                        },
                        push: {
                            particles_nb: 4
                        }
                    }
                },
                retina_detect: true
            });
        }

        // Load countries from Radio Browser API
        function loadCountries() {
            elements.countrySelect.innerHTML = '<option value="">' + translate('loadingCountries') + '</option>';
            
            fetch('https://de1.api.radio-browser.info/json/countries')
                .then(response => response.json())
                .then(data => {
                    state.countries = data
                        .filter(country => country.stationcount > 0)
                        .sort((a, b) => b.stationcount - a.stationcount);
                    
                    populateCountrySelect();
                })
                .catch(error => {
                    console.error('Error loading countries:', error);
                    showError(translate('errorLoading'));
                });
        }

        // Populate country select dropdown
        function populateCountrySelect() {
            elements.countrySelect.innerHTML = '';
            
            const defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.textContent = 'All Countries';
            elements.countrySelect.appendChild(defaultOption);
            
            state.countries.forEach(country => {
                const option = document.createElement('option');
                option.value = country.name;
                option.textContent = `${country.name} (${country.stationcount})`;
                elements.countrySelect.appendChild(option);
            });
        }

        // Load stations by country from Radio Browser API
        function loadStations(country = '') {
            elements.stationsContainer.innerHTML = `
                <div class="station-item skeleton">
                    <div class="station-item-content">
                        <div class="skeleton skeleton-text" style="width: 70%"></div>
                        <div class="skeleton skeleton-text-sm" style="width: 50%"></div>
                    </div>
                </div>
                <div class="station-item skeleton">
                    <div class="station-item-content">
                        <div class="skeleton skeleton-text" style="width: 80%"></div>
                        <div class="skeleton skeleton-text-sm" style="width: 60%"></div>
                    </div>
                </div>
                <div class="station-item skeleton">
                    <div class="station-item-content">
                        <div class="skeleton skeleton-text" style="width: 60%"></div>
                        <div class="skeleton skeleton-text-sm" style="width: 40%"></div>
                    </div>
                </div>
            `;
            
            let url = 'https://de1.api.radio-browser.info/json/stations/search?limit=100&hidebroken=true&order=votes&reverse=true';
            if (country) {
                url += `&country=${encodeURIComponent(country)}`;
            }
            
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    state.stations = data;
                    state.filteredStations = [...data];
                    renderStations();
                    updateStationsCount();
                })
                .catch(error => {
                    console.error('Error loading stations:', error);
                    showError(translate('errorLoading'));
                });
        }

        // Filter stations by search term
        function filterStations(searchTerm = '') {
            if (!searchTerm) {
                state.filteredStations = [...state.stations];
            } else {
                const term = searchTerm.toLowerCase();
                state.filteredStations = state.stations.filter(station => 
                    station.name.toLowerCase().includes(term) || 
                    (station.tags && station.tags.toLowerCase().includes(term)) ||
                    (station.country && station.country.toLowerCase().includes(term))
                );
            }
            
            renderStations();
            updateStationsCount();
        }

        // Render stations list
        function renderStations() {
            elements.stationsContainer.innerHTML = '';
            
            if (state.filteredStations.length === 0) {
                const noResults = document.createElement('div');
                noResults.className = 'station-item';
                noResults.textContent = 'No stations found';
                elements.stationsContainer.appendChild(noResults);
                return;
            }
            
            state.filteredStations.forEach(station => {
                const stationItem = document.createElement('div');
                stationItem.className = 'station-item';
                if (state.currentStation && state.currentStation.id === station.id) {
                    stationItem.classList.add('active');
                }
                
                stationItem.innerHTML = `
                    <div class="station-item-content">
                        <div class="station-item-name">${station.name}</div>
                        <div class="station-item-tags">
                            ${station.tags ? station.tags.split(',').slice(0, 3).map(tag => 
                                `<span class="tag">${tag.trim()}</span>`
                            ).join('') : ''}
                        </div>
                    </div>
                    <div class="station-item-actions">
                        <button class="fav-btn ${isFavorite(station.id) ? 'favorited' : ''}" 
                                data-id="${station.id}" 
                                aria-label="${isFavorite(station.id) ? 'Remove from favorites' : 'Add to favorites'}">
                            <span class="icon ${isFavorite(station.id) ? 'icon-faved' : 'icon-fav'}" aria-hidden="true"></span>
                        </button>
                        ${state.currentStation && state.currentStation.id === station.id ? 
                            `<span class="play-indicator blinking">
                                <span class="icon icon-now-playing" aria-hidden="true"></span>
                                <span>${translate('nowPlaying')}</span>
                            </span>` : ''}
                    </div>
                `;
                
                stationItem.addEventListener('click', () => playStation(station));
                
                // Add favorite button event listener
                const favBtn = stationItem.querySelector('.fav-btn');
                favBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleFavorite(station);
                });
                
                elements.stationsContainer.appendChild(stationItem);
            });
        }

        // Update stations count display
        function updateStationsCount() {
            elements.stationsCount.textContent = translate('stationCount', { count: state.filteredStations.length });
        }

        // Play a station
        function playStation(station) {
            // Stop current playback
            elements.audioPlayer.pause();
            
            // Set new station
            state.currentStation = station;
            
            // Update UI
            updateNowPlaying();
            renderStations();
            updatePlayButton();
            
            // Try to play the station
            elements.audioPlayer.src = station.url_resolved || station.url;
            elements.audioPlayer.play().catch(error => {
                console.error('Error playing station:', error);
                showError('Error playing station. Please try another one.');
            });
        }

        // Toggle play/pause
        function togglePlay() {
            if (!state.currentStation) {
                if (state.filteredStations.length > 0) {
                    playStation(state.filteredStations[0]);
                }
                return;
            }
            
            if (state.isPlaying) {
                elements.audioPlayer.pause();
            } else {
                elements.audioPlayer.play().catch(error => {
                    console.error('Error resuming playback:', error);
                });
            }
        }

        // Update play button state
        function updatePlayButton() {
            const icon = elements.playBtn.querySelector('.icon');
            
            if (state.isPlaying) {
                elements.playBtn.setAttribute('aria-label', 'Pause');
                icon.classList.remove('icon-play');
                icon.classList.add('icon-pause');
            } else {
                elements.playBtn.setAttribute('aria-label', 'Play');
                icon.classList.remove('icon-pause');
                icon.classList.add('icon-play');
            }
        }

        // Update now playing info
        function updateNowPlaying() {
            if (state.currentStation) {
                elements.currentStationName.textContent = state.currentStation.name;
                elements.currentStationCountry.textContent = state.currentStation.country || 'Unknown country';
                
                // Update metadata if available
                if (state.currentStation.bitrate) {
                    elements.currentBitrate.textContent = `${translate('bitrate')}: ${state.currentStation.bitrate}kbps`;
                } else {
                    elements.currentBitrate.textContent = '-';
                }
                
                if (state.currentStation.codec) {
                    elements.currentCodec.textContent = `${translate('codec')}: ${state.currentStation.codec.toUpperCase()}`;
                } else {
                    elements.currentCodec.textContent = '-';
                }
            } else {
                elements.currentStationName.textContent = translate('noStation');
                elements.currentStationCountry.textContent = translate('selectStation');
                elements.currentBitrate.textContent = '-';
                elements.currentCodec.textContent = '-';
            }
        }

        // Load favorites from localStorage
        function loadFavorites() {
            const favorites = localStorage.getItem('radioFavorites');
            if (favorites) {
                state.favorites = JSON.parse(favorites);
                renderFavorites();
            }
        }

        // Save favorites to localStorage
        function saveFavorites() {
            localStorage.setItem('radioFavorites', JSON.stringify(state.favorites));
        }

        // Check if station is favorite
        function isFavorite(stationId) {
            return state.favorites.some(fav => fav.id === stationId);
        }

        // Toggle favorite status of a station
        function toggleFavorite(station) {
            const index = state.favorites.findIndex(fav => fav.id === station.id);
            
            if (index === -1) {
                // Add to favorites
                state.favorites.push({
                    id: station.id,
                    name: station.name,
                    country: station.country,
                    url: station.url_resolved || station.url,
                    tags: station.tags
                });
            } else {
                // Remove from favorites
                state.favorites.splice(index, 1);
            }
            
            saveFavorites();
            renderStations();
            renderFavorites();
        }

        // Render favorites list
        function renderFavorites() {
            elements.favoritesList.innerHTML = '';
            
            if (state.favorites.length === 0) {
                const noFavorites = document.createElement('div');
                noFavorites.className = 'station-item';
                noFavorites.textContent = 'No favorites yet';
                elements.favoritesList.appendChild(noFavorites);
                return;
            }
            
            state.favorites.forEach(fav => {
                const favItem = document.createElement('div');
                favItem.className = 'station-item';
                if (state.currentStation && state.currentStation.id === fav.id) {
                    favItem.classList.add('active');
                }
                
                favItem.innerHTML = `
                    <div class="station-item-content">
                        <div class="station-item-name">${fav.name}</div>
                        <div class="station-item-tags">
                            ${fav.tags ? fav.tags.split(',').slice(0, 3).map(tag => 
                                `<span class="tag">${tag.trim()}</span>`
                            ).join('') : ''}
                        </div>
                    </div>
                    <div class="station-item-actions">
                        <button class="fav-btn favorited" 
                                data-id="${fav.id}" 
                                aria-label="Remove from favorites">
                            <span class="icon icon-faved" aria-hidden="true"></span>
                        </button>
                        ${state.currentStation && state.currentStation.id === fav.id ? 
                            `<span class="play-indicator blinking">
                                <span class="icon icon-now-playing" aria-hidden="true"></span>
                                <span>${translate('nowPlaying')}</span>
                            </span>` : ''}
                    </div>
                `;
                
                favItem.addEventListener('click', () => {
                    // Find the full station data if available
                    const fullStation = state.stations.find(s => s.id === fav.id) || fav;
                    playStation(fullStation);
                });
                
                // Add favorite button event listener
                const favBtn = favItem.querySelector('.fav-btn');
                favBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleFavorite(fav);
                });
                
                elements.favoritesList.appendChild(favItem);
            });
        }

        // Show error message
        function showError(message) {
            const errorElement = document.createElement('div');
            errorElement.className = 'error-message';
            errorElement.innerHTML = `
                <span class="icon icon-error" aria-hidden="true"></span>
                <span>${message}</span>
            `;
            
            // Insert at the beginning of the main content
            document.querySelector('.main-content').prepend(errorElement);
            
            // Remove after 5 seconds
            setTimeout(() => {
                errorElement.remove();
            }, 5000);
        }

        // Translate text
        function translate(key, params = {}) {
            let translation = state.translations[state.language]?.[key] || state.translations.en[key] || key;
            
            // Replace placeholders
            for (const [param, value] of Object.entries(params)) {
                translation = translation.replace(`{${param}}`, value);
            }
            
            return translation;
        }

        // Update UI translations
        function updateUI() {
            // Update static texts
            document.querySelector('.favorites-section h3').textContent = translate('favorites');
            document.querySelector('.stations-title').textContent = translate('stations');
            elements.searchInput.placeholder = translate('searchPlaceholder');
            elements.modalTitle.textContent = translate('settings');
            document.querySelector('.settings-title').textContent = translate('appearance');
            document.querySelectorAll('.settings-group h3')[1].textContent = translate('language');
            elements.saveSettingsBtn.textContent = translate('save');
            
            // Update dynamic texts
            updateNowPlaying();
            updateStationsCount();
            
            // Update country select placeholder
            if (elements.countrySelect.firstChild.value === '') {
                elements.countrySelect.firstChild.textContent = translate('loadingCountries');
            }
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>