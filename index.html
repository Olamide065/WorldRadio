<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Eflez Radio</title>

<style>
:root {
  --primary: #4285f4;
  --bg: #ffffff;
  --text: #111;
  --border: #ddd;
}

[data-theme="dark"] {
  --bg: #121212;
  --text: #f1f1f1;
  --border: #333;
  --primary: #8ab4f8;
}

body {
  margin: 0;
  background: var(--bg);
  font-family: Arial, sans-serif;
  color: var(--text);
}

header {
  padding: 15px;
  background: var(--primary);
  color: #fff;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.logo {
  font-size: 22px;
  font-weight: bold;
}

.settings-btn {
  background: transparent;
  border: none;
  color: white;
  font-size: 24px;
  cursor: pointer;
}

.container { padding: 15px; }

.search-filter { display: flex; gap: 10px; margin-bottom: 15px; }

.search-input, select {
  width: 100%;
  padding: 10px;
  border: 1px solid var(--border);
  border-radius: 6px;
}

.station-item {
  padding: 12px;
  border: 1px solid var(--border);
  border-radius: 6px;
  margin-bottom: 8px;
  cursor: pointer;
}

.station-item:hover { background: rgba(0,0,0,0.1); }

.player-box {
  padding: 15px;
  border: 1px solid var(--border);
  margin-bottom: 20px;
  border-radius: 6px;
}

.play-btn, .pause-btn {
  padding: 10px 20px;
  background: var(--primary);
  color: #fff;
  border: none;
  border-radius: 6px;
  margin-top: 10px;
  cursor: pointer;
  font-size: 16px;
}

.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.6);
  display: none;
  justify-content: center;
  align-items: center;
}

.modal-overlay.active { display: flex; }

.modal {
  background: var(--bg);
  padding: 20px;
  width: 90%;
  max-width: 400px;
  border-radius: 8px;
  color: var(--text);
}

.modal label {
  font-weight: bold;
  display: block;
  margin-top: 10px;
}

.modal select {
  width: 100%;
  padding: 10px;
  border-radius: 6px;
  border: 1px solid var(--border);
}

.close-settings {
  background: var(--primary);
  color: #fff;
  border: none;
  padding: 10px 20px;
  margin-top: 20px;
  border-radius: 6px;
  cursor: pointer;
}
</style>
</head>

<body>

<header>
  <div class="logo" id="txt-eflez-radio">Eflez Radio</div>
  <button id="open-settings" class="settings-btn">‚öôÔ∏è</button>
</header>

<div class="container">

<div class="player-box">
  <h2 id="station-name">No station selected</h2>
  <p id="station-country">Select a station to start listening</p>

  <button class="play-btn" id="playBtn">‚ñ∂ Play</button>
  <button class="pause-btn" id="pauseBtn" style="display:none;">‚è∏ Pause</button>
</div>

<div class="search-filter">
  <input type="text" id="searchBox" class="search-input" placeholder="Search countries...">
  <select id="countryList"></select>
</div>

<div id="stationsContainer"></div>

</div>

<!-- SETTINGS MODAL -->
<div class="modal-overlay" id="settingsModal">
  <div class="modal">
    <h2 id="txt-settings">Settings</h2>

    <label id="txt-language">Language:</label>
    <select id="languageSelect">
      <option value="en">English</option>
      <option value="fr">French</option>
      <option value="es">Spanish</option>
      <option value="ar">Arabic</option>
      <option value="yo">Yoruba</option>
      <option value="ig">Igbo</option>
      <option value="ha">Hausa</option>
    </select>

    <label id="txt-theme">Theme:</label>
    <select id="themeSelect">
      <option value="light">Light</option>
      <option value="dark">Dark</option>
    </select>

    <button class="close-settings" id="closeSettings">Close</button>
  </div>
</div>

<audio id="audioPlayer" crossorigin="anonymous"></audio>

<script>
// TRANSLATION SYSTEM
const translations = {
  en:{ "eflez-radio":"Eflez Radio","settings":"Settings","language":"Language","theme":"Theme",
       "no-station":"No station selected","select-station":"Select a station to start listening",
       "play":"Play","pause":"Pause","search":"Search countries..." },
  fr:{ "eflez-radio":"Radio Eflez","settings":"Param√®tres","language":"Langue","theme":"Th√®me",
       "no-station":"Aucune station s√©lectionn√©e","select-station":"S√©lectionnez une station pour commencer",
       "play":"Lire","pause":"Pause","search":"Rechercher des pays..." },
  es:{ "eflez-radio":"Radio Eflez","settings":"Configuraci√≥n","language":"Idioma","theme":"Tema",
       "no-station":"No hay estaci√≥n seleccionada","select-station":"Seleccione una estaci√≥n para escuchar",
       "play":"Reproducir","pause":"Pausa","search":"Buscar pa√≠ses..." },
  ar:{ "eflez-radio":"ÿ±ÿßÿØŸäŸà ÿ•ŸÅŸÑŸäÿ≤","settings":"ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™","language":"ÿßŸÑŸÑÿ∫ÿ©","theme":"ÿßŸÑŸàÿ∂ÿπ",
       "no-station":"ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿ≠ÿ∑ÿ© ŸÖÿ≠ÿØÿØÿ©","select-station":"ÿßÿÆÿ™ÿ± ŸÖÿ≠ÿ∑ÿ© ŸÑÿ®ÿØÿ° ÿßŸÑÿßÿ≥ÿ™ŸÖÿßÿπ",
       "play":"ÿ™ÿ¥ÿ∫ŸäŸÑ","pause":"ÿ•ŸäŸÇÿßŸÅ ŸÖÿ§ŸÇÿ™","search":"ÿßÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑÿØŸàŸÑ..." },
  yo:{ "eflez-radio":"Eflez Radio","settings":"√Äw·ªçn √àt√≤","language":"√àd√®","theme":"√Äw·ªçÃÄ",
       "no-station":"Ko si ibudo ti a yan","select-station":"Yan ibudo lati b·∫πr·∫π gbigb·ªç",
       "play":"·π¢ere","pause":"D√∫r√≥ d√≠·∫πÃÄ","search":"Wa or√≠l·∫πÃÄ-√®d√®..." },
  ig:{ "eflez-radio":"Eflez Radio","settings":"Nhazi","language":"As·ª•s·ª•","theme":"Agba",
       "no-station":"Enwegh·ªã ·ªçd·ª• h·ªçr·ªç","select-station":"H·ªçr·ªç ·ªçd·ª• ka ·ªã malite ·ªãn·ª•",
       "play":"Gwuo","pause":"Kw·ª•s·ªã","search":"Ch·ªç·ªç mba..." },
  ha:{ "eflez-radio":"Rediyon Eflez","settings":"Saituna","language":"Harshe","theme":"Yanayin",
       "no-station":"Babu tashar da aka za…ìa","select-station":"Za…ìi tasha don fara sauraro",
       "play":" kunna","pause":"Tsaya","search":"Nemo ∆ôasashe..." }
};

// APPLY TRANSLATION
function translateUI(lang){
  const t = translations[lang];
  document.getElementById("txt-eflez-radio").textContent = t["eflez-radio"];
  document.getElementById("txt-settings").textContent = t["settings"];
  document.getElementById("txt-language").textContent = t["language"];
  document.getElementById("txt-theme").textContent = t["theme"];
  document.getElementById("station-name").textContent = t["no-station"];
  document.getElementById("station-country").textContent = t["select-station"];
  document.getElementById("searchBox").placeholder = t["search"];
  document.getElementById("playBtn").textContent = "‚ñ∂ " + t["play"];
  document.getElementById("pauseBtn").textContent = "‚è∏ " + t["pause"];
}

// LOAD SAVED THEME
const savedTheme = localStorage.getItem("theme") || "light";
document.documentElement.setAttribute("data-theme", savedTheme);
document.getElementById("themeSelect").value = savedTheme;

// LOAD SAVED LANG
const savedLang = localStorage.getItem("lang") || "en";
document.getElementById("languageSelect").value = savedLang;
translateUI(savedLang);

// SETTINGS POPUP
document.getElementById("open-settings").onclick = () =>
  document.getElementById("settingsModal").classList.add("active");

document.getElementById("closeSettings").onclick = () =>
  document.getElementById("settingsModal").classList.remove("active");

// CHANGE LANGUAGE
document.getElementById("languageSelect").onchange = function(){
  localStorage.setItem("lang", this.value);
  translateUI(this.value);
};

// CHANGE THEME
document.getElementById("themeSelect").onchange = function(){
  localStorage.setItem("theme", this.value);
  document.documentElement.setAttribute("data-theme", this.value);
};

// RADIO FUNCTIONS
const audio = document.getElementById("audioPlayer");
let stations = [];
let selectedStation = null;

// BACKGROUND PLAY SUPPORT
if ("mediaSession" in navigator) {
  navigator.mediaSession.setActionHandler("play", () => audio.play());
  navigator.mediaSession.setActionHandler("pause", () => audio.pause());
}

// LOAD COUNTRIES
function loadCountries(){
  fetch("https://de1.api.radio-browser.info/json/countries")
    .then(r=>r.json())
    .then(data=>{
      data.sort((a,b)=>a.name.localeCompare(b.name));
      let options = `<option value="">All Countries</option>`;
      data.forEach(c=>{
        if(c.stationcount>0) options += `<option value="${c.name}">${c.name} (${c.stationcount})</option>`;
      });
      document.getElementById("countryList").innerHTML = options;
    });
}
loadCountries();

// SEARCH FILTER
document.getElementById("searchBox").oninput = function(){
  let term = this.value.toLowerCase();
  let list = document.getElementById("countryList");
  for (let opt of list.options){
    opt.style.display = opt.text.toLowerCase().includes(term) ? "block" : "none";
  }
};

// LOAD STATIONS
document.getElementById("countryList").onchange = function(){
  let country = this.value;
  document.getElementById("stationsContainer").innerHTML = "<p>Loading...</p>";

  let url = "https://de1.api.radio-browser.info/json/stations/search?limit=100&hidebroken=true";
  if(country) url += `&country=${encodeURIComponent(country)}`;

  fetch(url).then(r=>r.json()).then(data=>{
    stations = data;
    displayStations();
  });
};

// SHOW STATIONS
function displayStations(){
  let html = "";
  stations.forEach(st=>{
    html += `<div class="station-item" onclick='playStation(${JSON.stringify(st)})'>
               <strong>${st.name}</strong><br>
               <small>${st.country}</small>
             </div>`;
  });
  document.getElementById("stationsContainer").innerHTML = html;
}

// PLAY STATION + TRIGGER ANDROID AD
function playStation(st){
  selectedStation = st;

  document.getElementById("station-name").textContent = st.name;
  document.getElementById("station-country").textContent = st.country;

  audio.src = st.url_resolved || st.url;
  audio.play();

  document.getElementById("playBtn").style.display = "none";
  document.getElementById("pauseBtn").style.display = "inline-block";

  // üî• Android ad trigger when selecting channel
  if (typeof Android !== "undefined" && Android.showAd) {
      Android.showAd();
  }

  if ("mediaSession" in navigator){
    navigator.mediaSession.metadata = new MediaMetadata({
      title: st.name,
      artist: st.country,
      album: "Eflez Radio"
    });
  }
}

// PLAY BUTTON
document.getElementById("playBtn").onclick = () => {
  audio.play();
  document.getElementById("playBtn").style.display = "none";
  document.getElementById("pauseBtn").style.display = "inline-block";
};

// PAUSE BUTTON + Android Ad Trigger
document.getElementById("pauseBtn").onclick = () => {
  audio.pause();
  document.getElementById("pauseBtn").style.display = "none";
  document.getElementById("playBtn").style.display = "inline-block";

  // üî• Android ad trigger on pause
  if (typeof Android !== "undefined" && Android.showAd) {
      Android.showAd();
  }
};
</script>

</body>
    </html>
